WARNING:tensorflow:From /Users/mdrissi/Snapchat/Dev/distributed_tensorflow_weirdness/toy_train.py:27: _CollectiveAllReduceStrategyExperimental.__init__ (from tensorflow.python.distribute.collective_all_reduce_strategy) is deprecated and will be removed in a future version.
Instructions for updating:
use distribute.MultiWorkerMirroredStrategy instead
2022-10-07 19:25:08.376928: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-10-07 19:25:08.381155: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job chief -> {0 -> localhost:49386}
2022-10-07 19:25:08.381191: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:49384, 1 -> localhost:49385}
2022-10-07 19:25:08.381311: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:437] Started server with target: grpc://localhost:49384
WARNING:tensorflow:Waiting for the cluster, timeout = 5.0
2022-10-07 19:25:08.481287: W tensorflow/core/grappler/optimizers/data/auto_shard.cc:776] AUTO sharding policy will apply DATA sharding policy as it failed to apply FILE sharding policy because of the following reason: Found an unshardable source dataset: name: "TensorSliceDataset/_1"
op: "TensorSliceDataset"
input: "Placeholder/_0"
attr {
  key: "Toutput_types"
  value {
    list {
      type: DT_FLOAT
    }
  }
}
attr {
  key: "_cardinality"
  value {
    i: 9
  }
}
attr {
  key: "is_files"
  value {
    b: false
  }
}
attr {
  key: "metadata"
  value {
    s: "\n\024TensorSliceDataset:0"
  }
}
attr {
  key: "output_shapes"
  value {
    list {
      shape {
        dim {
          size: 1
        }
      }
    }
  }
}
experimental_type {
  type_id: TFT_PRODUCT
  args {
    type_id: TFT_DATASET
    args {
      type_id: TFT_PRODUCT
      args {
        type_id: TFT_TENSOR
        args {
          type_id: TFT_FLOAT
        }
      }
    }
  }
  args {
    type_id: TFT_DATASET
    args {
      type_id: TFT_PRODUCT
      args {
        type_id: TFT_TENSOR
        args {
          type_id: TFT_FLOAT
        }
      }
    }
  }
}

2022-10-07 19:25:08.511969: W tensorflow/core/framework/dataset.cc:768] Input of GeneratorDatasetOp::Dataset will not be optimized because the dataset does not implement the AsGraphDefInternal() method needed to apply optimizations.
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
[[7]]
[[1]]
[[4]]
